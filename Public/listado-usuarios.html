<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administración de usuarios</title>
    <link rel="stylesheet" href="/css/style.css">
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    
</head>

<body class="home">
    <div class="menu-btn" id="menu-btn">
        <ion-icon name="menu-outline"></ion-icon>
    </div>

    <nav class="sidebar" id="sidebar">
        <div class="sidebar-logo">
            <img src="/Assets/Logo.png" alt="">
            <h3>Manzanas del</h3>
            <h3>Cuidado</h3>
        </div>
        <ul>
            <li class="submenu">

                    <a href="#" class="submenu-btn">
                        <div class="submenu-item">
                        <ion-icon name="home-outline" class="home-icon"></ion-icon>
                        <p>Inicio</p>
                        <ion-icon name="chevron-down-outline" class="down-icon"></ion-icon>
                    </div>
                    </a>
                
                <ul class="submenu-content">
                    <li><a href="#">Dashboard</a></li>
                    <li><a href="#">Mi Perfil</a></li>
                    <li><a href="/listado-usuarios.html">Usuarios</a></li>
                </ul>
            </li>

            <li><a href="/Servicios.html">Servicios</a></li>
            <li><a href="#">Cerrar Sesion</a></li>
            
        </ul>

    </nav>

    <div class="content">
        <h1>Listado De Servicios</h1>
        <div class="button">
        <a href="/crear.html"><input type="submit" value="Crear Servicio"></a>
    </div>
        <table>
            <thead>
                <tr>
                    <th>ID Usuario</th>
                    <th>Nombre Usuario</th>
                    <th>Email Usuario</th>
                    <th>Acciones</th>
                </tr>
                
            </thead>
            <tbody id="usersTable">
                <tr>
                    <td class="actions"><a href="/Actualizar.html"><ion-icon name="create-outline" class="editar"></ion-icon></a>
                    <a href=""><ion-icon name="trash-outline" class="eliminar" onclick=""></ion-icon></a></td>
                </tr>
            </tbody>
        </table>
        
    </div>

    <script src="/Js/script-2.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        fetch('http://localhost:3000/admin/getUsers')
            .then( res => res.json())
            .then( data => {
                const usersTable = document.getElementById('usersTable')
                usersTable.innerHTML = ''
                data.forEach(user => {
                    const row = document.createElement('tr')

                        // Columna ID de usuario
                        const idCell = document.createElement('td')
                        idCell.textContent = user.Usu_ID
                        row.appendChild(idCell)

                        // Columna Nombre de usuario
                        const nameCell = document.createElement('td')
                        nameCell.textContent = user.Usu_Nombre
                        row.appendChild(nameCell)

                        // Columna Email de usuario
                        const emailCell = document.createElement('td')
                        emailCell.textContent = user.Usu_Email
                        row.appendChild(emailCell)

                        // Columna de Acciones con los iconos de editar y eliminar
                        const actionsCell = document.createElement('td')
                        actionsCell.classList.add('actions')
                        
                        // Icono de editar
                        const editLink = document.createElement('a')
                        editLink.href = "/Actualizar.html"
                        const editIcon = document.createElement('ion-icon')
                        editIcon.name = 'create-outline'
                        editIcon.classList.add('editar')
                        editLink.appendChild(editIcon)
                        actionsCell.appendChild(editLink)

                        // Icono de eliminar
                        const deleteLink = document.createElement('a')
                        deleteLink.href = "#"
                        const deleteIcon = document.createElement('ion-icon')
                        deleteIcon.name = 'trash-outline'
                        deleteIcon.classList.add('eliminar')
                        deleteIcon.onclick = () => eliminarUsuario(user.Usu_ID)
                        deleteLink.appendChild(deleteIcon)
                        actionsCell.appendChild(deleteLink)

                        row.appendChild(actionsCell)

                        // Añade la fila al cuerpo de la tabla
                        usersTable.appendChild(row)
                })
            })
    </script>


</body>

</html>